@model MMUniGraduation.Models.Create.CreateLecture

@{
    var courses = Model.Courses
        .Select(x => new SelectListItem(x.Value, x.Key));
    var lectures = Model.AllLectures
        .Select(x => new SelectListItem(x.Value, x.Key));
}

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    .btn {
        border: none;
        color: white;
        padding: 14px 28px;
        font-size: 16px;
        cursor: pointer;
    }

    .success {
        background-color: #04AA6D;
    }
        /* Green */
        .success:hover {
            background-color: #46a049;
        }

    .info {
        background-color: #2196F3;
    }
        /* Blue */
        .info:hover {
            background: #0b7dda;
        }
</style>

@*<h1 style="padding-top:25px; padding-bottom:1em; text-align:center;">@ViewData["Title"]</h1>*@
<h1 style="padding-top:25px; text-align:center;">Create Lecture</h1>
<form asp-action="Create" asp-controller="Lecture" enctype="multipart/form-data">
    <div>
        <h4>Lecture information</h4>
        <input asp-for="Name" class="form-control" type="text" placeholder="Lecture name"><br />
        <textarea asp-for="Description" class="form-control" type="text" placeholder="Lecture Description"></textarea>

        <br /><hr /><br />
        <h4>Lecture inheritance</h4>
        <label>Select corresponding course</label>
        @*<select asp-for="CourseId" class="form-control" asp-items="courses"></select>*@
        @Html.DropDownListFor(x => Model.CourseId, new SelectList(courses, "Value", "Text"), "---Select Course---", htmlAttributes: new { @class = "form-control", id = "Course" })
        <br />
        <label>Select parent lecture</label>
        @*<select asp-for="ParetntLectureId" class="form-control" asp-items="lectures">
                <option asp-for="ParetntId" value="0">No inheritance</option>
            </select>*@
        @Html.DropDownListFor(x => Model.ParetntLectureId, new SelectList(lectures, "Value", "Text"), "---No lecture inheritance---", htmlAttributes: new { @class = "form-control", @id = "Lecture" })

        <br />
        <hr />
        <br />

        <h4>Lecture materials..</h4>
        @*<label>HW Files</label>
            <input asp-for="HWFiles" class="form-control" />
            <br />*@

        <label>Lecture materials</label>
        <div class="input-group">
            <div class="custom-file form-control">
                <input asp-for="Files" class="custom-file-input form-control" id="inputGroupFile04">
                <label class="custom-file-label form-control" for="inputGroupFile04">Choose lecture materials</label>

                @*<input asp-for="Files" class="custom-file-input form-control" id="inputGroupFile04">
                    <label class="custom-file-label form-control" for="inputGroupFile04">Choose lecture materials</label>*@
            </div>
        </div>
        <br />
        <label>Homework materials</label>
        <div class="input-group">
            <div class="custom-file form-control">
                <input asp-for="HWFiles" class="custom-file-input form-control" id="inputGroupFile04">
                <label class="custom-file-label form-control" for="inputGroupFile04">Choose lecture materials</label>
            </div>
        </div>
        <br />
        <label>Video url</label>
        <input asp-for="VideoUrl" class="form-control" type="url" placeholder="Video url"><br />
        <hr />
        <br />
        <h4>Lecture criteria</h4>
        <div>
            <label>Is lecture final for the course: </label>
            @Html.EditorFor(x => x.IsFinal)
            <br />
            <label>Is lecture related with the final grade: </label>
            @Html.EditorFor(x => x.IsExam)
            <br />
            <label>Required grade:</label>
            <input asp-for="RequiredGrade" class="form-control" type="number" min="2" max="6" placeholder="Required grade" value="">
            <br />

            <div class="form-group">
                <label asp-for="DateTimeToShow" class="control-label"></label>
                <input asp-for="DateTimeToShow" class="form-control" />
                <span asp-validation-for="DateTimeToShow" class="text-danger"></span>
            </div>
            <br />
            <div class="form-group">
                <label asp-for="EndDateTimeForHW" class="control-label"></label>
                <input asp-for="EndDateTimeForHW" class="form-control" />
                <span asp-validation-for="EndDateTimeForHW" class="text-danger"></span>
            </div>
            <br />

            @*<label asp-for="IsExam" class="form-check-label" for="flexCheckDefault">Is it Exam?</label>*@
            @*<input class="form-control" type="text" placeholder="Select students who can see the course"><br />
                <input class="form-control" type="text" placeholder="Enter min grade to be shown"><br />
                <input class="form-control" type="text" placeholder="Enter min count of submitted HW"><br />*@

        </div>

    </div>
    @*<br />*@
    <button class="btn info">Create</button>
</form>
@section Scripts {
    @*@{await Html.RenderPartialAsync("_ValidationScriptsPartial");}*@

    <script type="text/javascript">
    $('#Course').change(function () {
                //we get selected value of programs
        var selectedCourse = $("#Course").val();
                var lecturesSelect = $('#Lecture');
        lecturesSelect.empty();
        lecturesSelect.append($('<option/>', {
            value: 0,
            text: "---No lecture inheritance---"
        }));
        if (selectedCourse != null && selectedCourse != '') {
                    //the result from GetLectures(int programId) is stored in lectures object
            $.getJSON('@Url.Action("GetLectures")', { courseId: selectedCourse }, function (dropdownData) {
                        if (dropdownData != null && !jQuery.isEmptyObject(dropdownData))
                        {
                            $.each(dropdownData, function (index, data) {
                                lecturesSelect.append($('<option/>', {
                                    value: data.value,
                                    text: data.text
                                }));
                            });
                };
                    });
                }
            });
    </script>
}

