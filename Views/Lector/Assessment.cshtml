@model MMUniGraduation.ViewModels.AssessmentsViewModel

@{
    var programs = Model.StudyPrograms
        .Select(x => new SelectListItem(x.Value, x.Key));
    var courses = Model.Courses
        .Select(x => new SelectListItem(x.Value, x.Key));
    var lectures = Model.Lectures
        .Select(x => new SelectListItem(x.Value, x.Key));
}

<style>
    hr {
        border-color: lightblue;
    }
</style>
<script>
    function optionSelectedProgram(value) {
        alert(value)

    }
</script>

<h2 style="text-align: center; padding-top: 1em; ">Assessment Page</h2>
<!-- <h1 style="padding-top:25px; text-align:center;">@ViewData["Title"]</h1>   -->
<div style="padding-top: 1em;">
    <h3 onclick="showFilters()" style="text-align: center; padding-top: 1em; ">
        Filters
    </h3>

    <form asp-controller="Lector" asp-action="Assessment" enctype="multipart/form-data">
        <div id="show-filters">
            <label>Select program</label>
            @*<select asp-for="ProgramId" class="form-control" asp-items="programs" onchange="optionSelectedProgram(this.value)">*@
            <select asp-for="ProgramId" class="form-control" asp-items="programs" onchange="optionSelectedProgram(this.value)">
                @*<option value="" selected disabled hidden>Choose program</option>*@
            </select>
            <br />

            <label>Select course</label>
            <select asp-for="CourseId" class="form-control" asp-items="courses"></select>
            <br />

            <label>Select lecture</label>
            <select asp-for="LectureId" class="form-control" asp-items="lectures"></select>
            <br />

            <label>Select kind of assessment</label>
            <select asp-for="KindOfAssessment" class="form-control">
                <option value="Homeworks">Homeworks</option>
                <option value="ExamSolutions">Exam solutions</option>
                <option value="AllAssessments">All</option>
            </select>
            <br />

            @*<select class="form-control" placeholder="Lector">
                    <option value="1">Select Lector</option>
                    <option>Pesho</option>
                    <option>Mitko</option>
                    <option>Select from existing Programs in DB</option>
                </select><br />*@

            <br />
            <button class="btn btn-outline-info" style="text-align:right;">Search</button>
        </div>
    </form>
</div>
<br />

<div class="container">
    <h4 style="text-align: center; padding-top: 1em;">Аssessment tasks</h4>
    @foreach (var course in Model.AllCourses)
    {
        @foreach (var lecture in course.Lectures)
        {
            foreach (var file in lecture.Homeworks)
            {
                <hr />
                <div class="row">
                    <div class="col">
                        <p>Course: @course.Signature @course.Name</p>
                        <p>Lecture: @lecture.Name</p>
                        @if (lecture.IsExam)
                        {
                            <p>Exam solution:</p>
                            <ul>
                                @Html.ActionLink(file.HomeworkName, "DownloadFile", new { Controller = "Course", fileName = file.Id + '.' + file.Extension, type = "examSolution" })
                            </ul>
                        }
                        else
                        {
                            <p>Homework solutions:</p>
                            <ul>
                                @Html.ActionLink(file.HomeworkName, "DownloadFile", new { Controller = "Course", fileName = file.Id + '.' + file.Extension, type = "homework" })
                            </ul>
                        }
                    </div>
                    <div class="col">
                        <form asp-controller="Lecture" asp-action="EditHomework" enctype="multipart/form-data">
                            <p>Student ID: @file.StudentId</p>
                            <p>Student Name: @Model.Students.FirstOrDefault(x => x.UserId == file.StudentId).FirstName @Model.Students.FirstOrDefault(x => x.UserId == file.StudentId).LastName </p>
                            <label>Grade/Points:</label>
                            <input asp-for="HomeworkGrade" type="text" class="form-control" placeholder="@file.Grade" value="@file.Grade"><br />
                            <label>Comment:</label>
                            <textarea asp-for="HomeworkComment" class="form-control" id="exampleFormControlTextarea1" rows="3" placeholder="@file.Comment"></textarea>
                            <input asp-for="HomeworkId" value="@file.Id" class="form-control" style="visibility:hidden;" \>
                            <button class="btn btn-outline-info" style="text-align:right;"><i class="fa fa-save"></i> Save</button>
                            <input asp-for="CourseId" value="@course.Id" class="form-control" style="visibility:hidden;" \>
                        </form>
                    </div>

                </div>
            }
        }
    }
</div>
